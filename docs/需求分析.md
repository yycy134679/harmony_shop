# **需求分析书 - 简易购物平台**

**版本：V1.1**

---

## **1. 项目概述与目标**

### **1.1 项目名称**
拼夕夕商店 (暂定)

### **1.2 项目愿景**
为鸿蒙大作业构建一个界面美观、交互流畅、**购物流程完整**的简易移动电商应用。项目旨在全面展示开发者在UI设计、组件化、页面导航和**数据持久化与状态管理**方面的综合能力。

### **1.3 核心目标**
1.  **实现完整的购物闭环**: 用户可以完成从 `浏览商品 -> 查看详情 -> 添加购物车 -> 管理购物车 -> 模拟结算` 的全过程。
2.  **卓越的UI/UX体验**: 提供统一、美观的界面设计和流畅的交互动画。
3.  **健壮的数据与状态管理**: 实现**持久化的用户账户系统**和**运行时的跨页面状态同步**。

### **1.4 关键约束**
*   **平台限制**: 所有功能必须在DevEco Studio的预览器（Previewer）中能够完整、正确地运行。
*   **数据方案**:
    *   **持久化数据**: 用户账户信息使用 **`@ohos.data.preferences`** 进行本地持久化存储，确保刷新预览器后数据不丢失。
    *   **运行时数据**: 购物车内容、用户当前登录状态等临时UI状态，使用 **`AppStorage`** 进行管理，实现跨页面实时响应。
    *   **静态数据**: 商品信息在代码中硬编码。

---

## **2. 应用架构与导航**

*(此部分与V1.0一致，保持不变)*

### **2.1 总体架构**
应用采用**底部标签栏 (Bottom Tab Bar)** 作为核心导航结构，提供一级页面的主要入口。

### **2.2 底部标签栏 (Tab Bar)**
包含两个主标签：
*   **首页**: 默认打开的页面，用于展示商品列表。
*   **购物车**: 展示和管理用户已添加的商品。

---

## **3. 核心功能需求 (Features)**

### **模块一：用户中心 (User Hub)**

| 功能点 | 需求描述 | 状态 | 备注/实现建议 |
| :--- | :--- | :--- | :--- |
| **3.1 用户注册** | 提供注册页面，用户可输入用户名、密码等信息。系统进行基本校验。 | **部分实现** | **待办**: 注册成功后，需使用 **`@ohos.data.preferences`** 将用户对象（序列化为JSON字符串）**持久化存储**到本地文件中。 |
| **3.2 用户登录** | 提供登录页面。用户输入用户名和密码进行登录。 | **部分实现** | **待办**: 需增加登录验证逻辑：**异步读取 `preferences`** 中的用户数据文件，解析后进行用户名和密码的匹配验证。 |
| **3.3 登录状态管理** | 用户的登录状态需在应用内全局保持，并驱动UI变化。 | **待实现** | **核心工作流**: <br>1. 登录验证成功后，将 `isLoggedIn: true` 和 `currentUser: '用户名'` 等**会话状态**写入 **`AppStorage`**。<br>2. 首页等UI组件监听 `AppStorage` 的变化，实时更新欢迎语等内容。 |

### **模块二：商品浏览 (Product Browsing)**

*(此部分与V1.0一致，保持不变)*

| 功能点 | 需求描述 | 状态 | 备注/实现建议 |
| :--- | :--- | :--- | :--- |
| **3.4 首页商品列表** | 作为应用入口，以网格或列表形式展示商品，包含图片、名称、价格和“+”加购按钮。支持按分类筛选商品。 | **部分实现** | **待办**: <br>1. 列表项的`“+”`按钮需绑定“加入购物车”逻辑。<br>2. 列表项的**卡片主体**需绑定“跳转到商品详情页”的路由事件。 |
| **3.5 商品详情页** | 点击首页商品卡片后进入的二级页面，用于展示商品的详细信息。 | **待实现** | **页面内容**: <br>1. 商品大图。<br>2. 商品全名、详细描述。<br>3. 价格。<br>4. 一个醒目的`“加入购物车”`按钮。 |

### **模块三：购物流程 (Shopping Flow)**

| 功能点 | 需求描述 | 状态 | 备注/实现建议 |
| :--- | :--- | :--- | :--- |
| **3.6 全局购物车** | 购物车数据需在应用内全局共享，不受页面切换影响。 | **待实现** | **核心方案**: 在 **`AppStorage`** 中维护一个购物车数组 `shoppingCart: CartItem[]`。<br>**注意**: 为简化实现，购物车内容**不要求持久化**，即刷新预览器后购物车清空。 |
| **3.7 加入购物车** | 用户可以将商品添加到购物车。 | **待实现** | 1. **触发点**: 点击首页列表的`“+”`按钮或详情页的`“加入购物车”`按钮。<br>2. **逻辑**: 修改 `AppStorage` 中的 `shoppingCart` 数组。 |
| **3.8 购物车角标** | 底部标签栏的“购物车”图标上，应实时显示购物车内商品的**总件数**。 | **待实现** | 使用`Badge`组件，其`value`绑定到根据 `AppStorage` 中 `shoppingCart` 数组计算出的总数量。 |
| **3.9 购物车页面** | 作为一级页面，通过底部标签栏进入，用于管理购物车内所有商品。 | **待实现** | **页面功能**: <br>1. 列表展示。<br>2. 数量调整。<br>3. 删除商品。<br>4. 清空购物车。<br>5. 总价显示。<br>6. 结算按钮。 |
| **3.10 模拟结算** | 用户完成购物的最后一步。 | **待实现** | 1. **触发点**: 点击购物车页面的`“去结算”`按钮。<br>2. **逻辑**: 清空 `AppStorage` 中的 `shoppingCart` 数据。<br>3. **跳转**: 跳转到 `CheckoutSuccessPage.ets` 页面。 |

---

## **4. 非功能性需求**

*(此部分与V1.0一致，保持不变)*

### **4.1 UI/UX 设计**
*   **一致性**: 应用内所有页面应遵循统一的设计规范。建议将`注册页`的背景图样式调整为与其他页面一致的简洁风格。
*   **动效**: 在页面跳转、元素增删时，可适当添加平滑的过渡动画，提升用户体验。

---

## **5. 技术方案与数据管理 (新增)**

本节明确定义了项目中核心数据管理的技术选型和职责划分。

### **5.1 数据持久化: `@ohos.data.preferences`**
*   **角色**: 应用的“**保险箱**”或“**记事本**”。
*   **职责**: 负责存储需要跨应用生命周期（包括刷新预览器、关闭应用）保留的数据。
*   **应用场景**:
    *   存储已注册的**用户账户列表**（用户名和密码）。

### **5.2 运行时状态管理: `AppStorage`**
*   **角色**: 应用的“**临时白板**”。
*   **职责**: 负责管理应用在**单次运行期间**需要在不同页面间共享的UI状态。它的数据会随着预览器刷新而重置。
*   **应用场景**:
    *   当前用户的**登录状态** (`isLoggedIn: boolean`)。
    *   当前登录用户的**用户名** (`currentUser: string`)。
    *   **购物车**中的商品内容 (`shoppingCart: CartItem[]`)。